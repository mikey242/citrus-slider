"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var citrus=function(){var t=[],e=function t(e){_classCallCheck(this,t),this.sliderContainer=e,this.slideText=function(t){for(var e={},i=0;i<t.length;i++)e[i]=t[i];return e}(e.children),this.num=e.children.length,this.imgUrls=function(t){var e=Array.from(t.children).map(function(t){return t.getElementsByTagName("img")[0].src}),i=t.getElementsByTagName("img");for(;i[0];)i[0].remove();return e}(e),this.settings={animateText:!0,animationDuration:.8,autoHeight:!1,autoPause:!0,effect:!1,height:"100%",paused:!1,showArrows:!0,showIndicators:!0,slideDuration:5e3,slideIndex:0,slideTransition:"pan",width:"100%"}};e.prototype.goToSlide=function(t){this.settings.slideIndex=t,n(this)},e.prototype.stop=function(){this.settings.paused=!0,clearTimeout(this.intervalSlideChange)},e.prototype.play=function(){this.settings.paused=!1,r(this)},e.prototype.prevSlide=function(){this.settings.slideIndex--,n(this)},e.prototype.nextSlide=function(){this.settings.slideIndex++,n(this)},e.prototype.reset=function(){window.removeEventListener("scroll",a),clearTimeout(this.intervalSlideChange),s(this),r(this)};var i=Array.from(document.getElementsByClassName("citrus-slider"));function s(t){var e=t.settings.height;!0===t.settings.autoHeight&&(e=function(t){for(var e=0,i=0;i<t.num;i++){var s=t.slideText[i].offsetHeight;e<s&&(e=s)}return(e+=250)+"px"}(t)),t.sliderContainer.setAttribute("style","width:"+t.settings.width+"; height:"+e),t.sliderHeight=t.sliderContainer.offsetHeight,t.sliderContainer.setAttribute("class","citrus-slider"),t.sliderContainer.classList.add("transition-"+t.settings.slideTransition),t.settings.effect&&t.sliderContainer.classList.add("effect-"+t.settings.effect),t.settings.animateText&&t.sliderContainer.classList.add("animate-text"),function(t){var e=document.createDocumentFragment(),i=document.createElement("DIV");0==t.settings.showArrows?i.setAttribute("class","citrus-arrows hidden"):i.setAttribute("class","citrus-arrows");var s=document.createElement("DIV");s.setAttribute("class","slide-arrow left-arrow");var r=document.createElement("DIV");r.setAttribute("class","slide-arrow right-arrow"),i.appendChild(s),i.appendChild(r),e.appendChild(i),t.arrows=[s,r];var d=document.createElement("DIV");t.slides=d,d.setAttribute("class","citrus-slides"),d.setAttribute("style","animation-duration:"+t.settings.animationDuration+"s;transition-duration:"+t.settings.animationDuration+"s;"),"pan"===t.settings.slideTransition&&(d.style.width=t.num+"00%");"pan"===t.settings.slideTransition&&(d.style.width=t.num+"00%",d.style.transform="translateX(-"+t.settings.slideIndex/t.num*100+"%)");for(var l=0;l<t.num;l++){var o=document.createElement("DIV");l===t.settings.slideIndex?o.setAttribute("class","slide-wrap current-slide"):o.setAttribute("class","slide-wrap");var c=document.createElement("DIV");c.setAttribute("class","slide");var u=t.slideText[l];u.setAttribute("class","slide-text"),c.style.backgroundImage="url("+t.imgUrls[l]+")",o.appendChild(c),o.appendChild(u),d.appendChild(o)}e.appendChild(d),t.indicators=[];var g=document.createElement("DIV");0==t.settings.showIndicators?g.setAttribute("class","citrus-indicators hidden"):g.setAttribute("class","citrus-indicators");for(var m=0;m<t.num;m++){var h=document.createElement("SPAN");m===t.settings.slideIndex?h.setAttribute("class","slide-indicator current-indicator"):h.setAttribute("class","slide-indicator"),h.setAttribute("data-slide",m),g.appendChild(h),e.appendChild(g),t.indicators[m]=h}t.sliderContainer.innerHTML="",t.sliderContainer.appendChild(e),"parallax"===t.settings.effect&&function(t){a(t),window.addEventListener("scroll",function(){"parallax"===t.settings.effect&&a(t)})}(t);!function(t){var e=!0,i=!1,s=void 0;try{for(var r,a=t.arrows[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var d=r.value;d.addEventListener("click",function(e){t.settings.autoPause&&(t.settings.paused=!0),t.sliderContainer.classList.contains("animating")||(t.settings.prevIndex=t.settings.slideIndex,e.target.classList.contains("left-arrow")?t.settings.slideIndex--:e.target.classList.contains("right-arrow")&&t.settings.slideIndex++,n(t))})}}catch(t){i=!0,s=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw s}}var l=!0,o=!1,c=void 0;try{for(var u,g=t.indicators[Symbol.iterator]();!(l=(u=g.next()).done);l=!0){var m=u.value;m.addEventListener("click",function(e){t.settings.autoPause&&(t.settings.paused=!0),t.sliderContainer.classList.contains("animating")||!1===e.target.classList.contains("current-indicator")&&(t.settings.prevIndex=t.settings.slideIndex,t.settings.slideIndex=Number(e.target.dataset.slide),n(t))})}}catch(t){o=!0,c=t}finally{try{!l&&g.return&&g.return()}finally{if(o)throw c}}}(t)}(t)}function n(t){if(clearTimeout(t.intervalSlideChange),t.prev=t.sliderContainer.getElementsByClassName("current-slide")[0],t.settings.slideIndex<0?(t.settings.slideIndex=t.num-1,t.num&&(t.indicators[0].parentElement.classList.add("transition-last"),setTimeout(function(){t.indicators[0].parentElement.classList.remove("transition-last")},1e3))):t.settings.slideIndex>t.num-1&&(t.settings.slideIndex=0,t.num&&(t.indicators[0].parentElement.classList.add("transition-first"),setTimeout(function(){t.indicators[0].parentElement.classList.remove("transition-first")},1e3))),t.num>1){t.sliderContainer.classList.remove("forwards","backwards");for(var e=0;e<t.num;e++)t.slides.children[e].classList.remove("current-slide","prev-slide","next-slide"),t.num&&t.indicators[e].classList.remove("current-indicator");t.settings.prevIndex<t.settings.slideIndex?t.sliderContainer.classList.add("forwards"):t.sliderContainer.classList.add("backwards"),t.prev.classList.add("prev-slide"),t.settings.slideIndex===t.num-1?t.slides.children[0].classList.add("next-slide"):t.slides.children[t.settings.slideIndex+1]&&t.slides.children[t.settings.slideIndex+1].classList.add("next-slide"),t.slides.children[t.settings.slideIndex].classList.add("current-slide"),t.num&&t.indicators[t.settings.slideIndex].classList.add("current-indicator"),"pan"===t.settings.slideTransition&&(t.sliderContainer.children[1].style.transform="translateX(-"+t.settings.slideIndex/t.num*100+"%)"),t.sliderContainer.classList.add("animating"),t.intervalPrevAnim=setTimeout(function(){t.sliderContainer.classList.remove("animating")},1e3*t.settings.animationDuration),r(t)}}function r(t){!1===t.settings.paused&&(t.intervalSlideChange=setTimeout(function(){t.settings.prevIndex=t.settings.slideIndex,t.settings.slideIndex++,n(t)},t.settings.slideDuration))}function a(t){var e=window.innerHeight;if(function(t,e,i){var s,n=t.getBoundingClientRect().top+i,r=t.getBoundingClientRect().bottom-i;s=!0===e?n<window.innerHeight&&r>=0:n>=0&&r<=window.innerHeight;return s}(t.sliderContainer,!0,0))for(var i=t.sliderContainer.getBoundingClientRect().top/e*(.3*t.sliderHeight),s=0;s<t.num;s++)t.slides.children[s].children[0].style.backgroundPosition="center calc(50% - "+i+"px)"}return i.forEach(function(n,a){t[a]=new e(i[a]);var d=t[a];!function(t,e){if(t.sliderContainer.hasAttribute("data-citrus")){var i=JSON.parse(t.sliderContainer.dataset.citrus),s=!0,n=!1,r=void 0;try{for(var a,d=Object.keys(i)[Symbol.iterator]();!(s=(a=d.next()).done);s=!0){var l=a.value;t.settings[l]=i[l]}}catch(t){n=!0,r=t}finally{try{!s&&d.return&&d.return()}finally{if(n)throw r}}t.sliderContainer.removeAttribute("data-citrus"),t.settings.slideIndex>t.num||t.settings.slideIndex<=0?t.settings.slideIndex=0:t.settings.slideIndex--}"function"==typeof e&&e(t)}(d,s),r(d)}),t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNpdHJ1cy1zbGlkZXIuanMiXSwibmFtZXMiOlsiY2l0cnVzIiwic2xpZGVyT2JqZWN0cyIsIlNsaWRlciIsInRoaXMiLCJzbGlkZXJDb250YWluZXIiLCJlbCIsImUiLCJzbGlkZVRleHQiLCJjaGlsZHJlbiIsImkiLCJnZXRDb250ZW50IiwibnVtIiwibGVuZ3RoIiwiaW1nVXJscyIsImFuaW1hdGlvbkR1cmF0aW9uIiwiYXV0b1NsaWRlIiwiZnJvbSIsIm1hcCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwic3JjIiwiaW1nIiwicmVtb3ZlIiwiZ2V0SW1hZ2VzIiwiYW5pbWF0ZVRleHQiLCJhdXRvSGVpZ2h0IiwiYXV0b1BhdXNlIiwiZWZmZWN0IiwiaGVpZ2h0IiwicGF1c2VkIiwic2hvd0Fycm93cyIsInNob3dJbmRpY2F0b3JzIiwicHJvdG90eXBlIiwiZ29Ub1NsaWRlIiwic2xpZGUiLCJzZXR0aW5ncyIsInNsaWRlSW5kZXgiLCJzbGlkZXJDaGFuZ2UiLCJzdG9wIiwiY2xlYXJUaW1lb3V0IiwicGxheSIsInByZXZTbGlkZSIsIm5leHRTbGlkZSIsInJlc2V0IiwidXBkYXRlUG9zaXRpb24iLCJzbGlkZXJJbml0IiwiQXJyYXkiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJnZXRTZXR0aW5ncyIsInNsaWRlRHVyYXRpb24iLCJ0ZXh0SGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0Iiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIndpZHRoIiwic2xpZGVySGVpZ2h0IiwiY2xhc3NMaXN0IiwiYWRkIiwic2xpZGVUcmFuc2l0aW9uIiwic2xpZGVyQ29uc3RydWN0IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImFycm93c0NvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhcnJvd1JpZ2h0IiwiYXBwZW5kQ2hpbGQiLCJhcnJvd0xlZnQiLCJhcnJvd3MiLCJmcmFnbWVudCIsInNsaWRlc0NvbnRhaW5lciIsInN0eWxlIiwic2xpZGVXcmFwIiwiYmFja2dyb3VuZEltYWdlIiwiaW5kaWNhdG9yc0NvbnRhaW5lciIsImluZGljYXRvcnMiLCJpbmRpY2F0b3IiLCJwcmV2SW5kZXgiLCJwYXJhbGxheEVmZmVjdCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwiYXJyb3ciLCJ2YWx1ZSIsInNldEJpbmRpbmdzIiwiY29udGFpbnMiLCJ0YXJnZXQiLCJlcnIiLCJyZXR1cm4iLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJOdW1iZXIiLCJkYXRhc2V0IiwiaW50ZXJ2YWxTbGlkZUNoYW5nZSIsInByZXYiLCJwYXJlbnRFbGVtZW50Iiwic2V0VGltZW91dCIsInNsaWRlcyIsImludGVydmFsUHJldkFuaW0iLCJ3aW5kb3dIZWlnaHQiLCJpbm5lckhlaWdodCIsImlzUGFydGlhbCIsIm9mZnNldCIsImlzVmlzaWJsZSIsImVsZW1Ub3AiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJlbGVtQm90dG9tIiwiYm90dG9tIiwidXJscyIsImlzU2Nyb2xsZWRJbnRvVmlldyIsInNsaWRlciIsInNsaWRlcnMiLCJjYiIsImhhc0F0dHJpYnV0ZSIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyJdLCJtYXBwaW5ncyI6IkFBY0EseUhBR0EsSUFBTUEsT0FBVSxXQUVkLElBQU1DLEtBRUFDLEVBRk4sU0FBQUEsRUFBTUQsR0FBQUEsZ0JBQUFBLEtBQUFBLEdBSUZFLEtBQUtDLGdCQUFrQkMsRUFG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IC5fXyAgX18gICAgICAgICAgICAgICAgICAgICAgIFxyXG4gIF9fX18gfF9ffC8gIHxfX19fX19fXyBfXyBfXyAgX19fX19fXHJcbl8vIF9fX1xcfCAgXFwgICBfX1xcXyAgX18gXFwgIHwgIFxcLyAgX19fL1xyXG5cXCAgXFxfX198ICB8fCAgfCAgfCAgfCBcXC8gIHwgIC9cXF9fXyBcXCBcclxuIFxcX19fICA+X198fF9ffCAgfF9ffCAgfF9fX18vL19fX18gID5cclxuICAgICBcXC8gICAgICAgICAgICAgICAgICAgICAgICAgICBcXC8gXHJcbiBWZXJzaW9uOiAxLjAuN1xyXG4gIEF1dGhvcjogTWljaGFlbCBJc2VhcmRcclxuIFdlYnNpdGU6IGh0dHBzOi8vY2l0cnVzLmlzZWFyZG1lZGlhLmNvbVxyXG4gICAgRG9jczogaHR0cHM6Ly9naXRlYS5pc2VhcmRtZWRpYS5jb20vbWljaGFlbC9jaXRydXMtU2xpZGVyXHJcbiAgICBSZXBvOiBodHRwczovL2dpdGVhLmlzZWFyZG1lZGlhLmNvbS9taWNoYWVsL2NpdHJ1cy1TbGlkZXJcclxuICovXHJcblxyXG5cInVzZSBzdHJpY3RcIlxyXG5cclxuLy8gQ1JFQVRFIFNMSURFUiBPQkpFQ1RTXHJcbmNvbnN0IGNpdHJ1cyA9IChmdW5jdGlvbiAoKSB7XHJcblxyXG4gIGNvbnN0IHNsaWRlck9iamVjdHMgPSBbXVxyXG5cclxuICBjbGFzcyBTbGlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoZWwpIHtcclxuICAgICAgdGhpcy5zbGlkZXJDb250YWluZXIgPSBlbFxyXG4gICAgICB0aGlzLnNsaWRlVGV4dCA9IGdldENvbnRlbnQoZWwuY2hpbGRyZW4pXHJcbiAgICAgIHRoaXMubnVtID0gZWwuY2hpbGRyZW4ubGVuZ3RoXHJcbiAgICAgIHRoaXMuaW1nVXJscyA9IGdldEltYWdlcyhlbClcclxuICAgICAgdGhpcy5zZXR0aW5ncyA9IHtcclxuICAgICAgICAvLyBkZWZhdWx0IHNldHRpbmdzXHJcbiAgICAgICAgYW5pbWF0ZVRleHQ6IHRydWUsXHJcbiAgICAgICAgYW5pbWF0aW9uRHVyYXRpb246IDAuOCxcclxuICAgICAgICBhdXRvSGVpZ2h0OiBmYWxzZSxcclxuICAgICAgICBhdXRvUGF1c2U6IHRydWUsXHJcbiAgICAgICAgZWZmZWN0OiBmYWxzZSxcclxuICAgICAgICBoZWlnaHQ6IFwiMTAwJVwiLFxyXG4gICAgICAgIHBhdXNlZDogZmFsc2UsXHJcbiAgICAgICAgc2hvd0Fycm93czogdHJ1ZSxcclxuICAgICAgICBzaG93SW5kaWNhdG9yczogdHJ1ZSxcclxuICAgICAgICBzbGlkZUR1cmF0aW9uOiA1MDAwLFxyXG4gICAgICAgIHNsaWRlSW5kZXg6IDAsXHJcbiAgICAgICAgc2xpZGVUcmFuc2l0aW9uOiBcInBhblwiLFxyXG4gICAgICAgIHdpZHRoOiBcIjEwMCVcIlxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBPQkpFQ1QgUFVCTElDIEZVTkNUSU9OU1xyXG4gIFNsaWRlci5wcm90b3R5cGUuZ29Ub1NsaWRlID0gZnVuY3Rpb24gKHNsaWRlKSB7XHJcbiAgICB0aGlzLnNldHRpbmdzLnNsaWRlSW5kZXggPSBzbGlkZVxyXG4gICAgc2xpZGVyQ2hhbmdlKHRoaXMpXHJcbiAgfVxyXG4gIFNsaWRlci5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuc2V0dGluZ3MucGF1c2VkID0gdHJ1ZVxyXG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuaW50ZXJ2YWxTbGlkZUNoYW5nZSlcclxuICB9XHJcbiAgU2xpZGVyLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncy5wYXVzZWQgPSBmYWxzZVxyXG4gICAgYXV0b1NsaWRlKHRoaXMpXHJcbiAgfVxyXG4gIFNsaWRlci5wcm90b3R5cGUucHJldlNsaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncy5zbGlkZUluZGV4LS1cclxuICAgICAgc2xpZGVyQ2hhbmdlKHRoaXMpXHJcbiAgfVxyXG4gIFNsaWRlci5wcm90b3R5cGUubmV4dFNsaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncy5zbGlkZUluZGV4KytcclxuICAgICAgc2xpZGVyQ2hhbmdlKHRoaXMpXHJcbiAgfVxyXG4gIFNsaWRlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdXBkYXRlUG9zaXRpb24pXHJcbiAgICBjbGVhclRpbWVvdXQodGhpcy5pbnRlcnZhbFNsaWRlQ2hhbmdlKVxyXG4gICAgc2xpZGVySW5pdCh0aGlzKVxyXG4gICAgYXV0b1NsaWRlKHRoaXMpXHJcbiAgfVxyXG5cclxuICAvLyBDUkVBVEUgSU5ESVZJRFVBTCBTTElERVIgT0JKRUNUUyBGUk9NIENPTlNUUlVDVE9SXHJcbiAgbGV0IHNsaWRlcnMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NpdHJ1cy1zbGlkZXInKSlcclxuICBzbGlkZXJzLmZvckVhY2goZnVuY3Rpb24gKHNsaWRlciwgaSkge1xyXG4gICAgc2xpZGVyT2JqZWN0c1tpXSA9IG5ldyBTbGlkZXIoc2xpZGVyc1tpXSlcclxuICAgIGxldCBlID0gc2xpZGVyT2JqZWN0c1tpXVxyXG4gICAgZ2V0U2V0dGluZ3MoZSwgc2xpZGVySW5pdClcclxuICAgIGF1dG9TbGlkZShlKVxyXG4gIH0pXHJcblxyXG4gIC8vIFNFVFMgQ0xBU1NFUyBBTkQgU0laRSBTTElERVIgQ09OVEFJTkVSXHJcbiAgZnVuY3Rpb24gc2xpZGVySW5pdChlKSB7XHJcbiAgICBsZXQgaGVpZ2h0ID0gZS5zZXR0aW5ncy5oZWlnaHRcclxuICAgIGlmIChlLnNldHRpbmdzLmF1dG9IZWlnaHQgPT09IHRydWUpIHtcclxuICAgICAgaGVpZ2h0ID0gYXV0b0hlaWdodChlKVxyXG4gICAgfVxyXG4gICAgZS5zbGlkZXJDb250YWluZXIuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJ3aWR0aDpcIiArIGUuc2V0dGluZ3Mud2lkdGggKyBcIjsgaGVpZ2h0OlwiICsgaGVpZ2h0KVxyXG4gICAgZS5zbGlkZXJIZWlnaHQgPSBlLnNsaWRlckNvbnRhaW5lci5vZmZzZXRIZWlnaHRcclxuICAgIGUuc2xpZGVyQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY2l0cnVzLXNsaWRlclwiKVxyXG4gICAgLy8gc2V0IGNvbnRhaW5lciBjbGFzc2VzXHJcbiAgICBlLnNsaWRlckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidHJhbnNpdGlvbi1cIiArIGUuc2V0dGluZ3Muc2xpZGVUcmFuc2l0aW9uKVxyXG4gICAgaWYgKGUuc2V0dGluZ3MuZWZmZWN0KSB7XHJcbiAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJlZmZlY3QtXCIgKyBlLnNldHRpbmdzLmVmZmVjdClcclxuICAgIH1cclxuICAgIGlmIChlLnNldHRpbmdzLmFuaW1hdGVUZXh0KSB7XHJcbiAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGUtdGV4dCcpXHJcbiAgICB9XHJcbiAgICBzbGlkZXJDb25zdHJ1Y3QoZSlcclxuICB9XHJcblxyXG4gIC8vIENPTlNUUlVDVCBET00gRUxFTUVOVFNcclxuICBmdW5jdGlvbiBzbGlkZXJDb25zdHJ1Y3QoZSkge1xyXG4gICAgbGV0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpXHJcblxyXG4gICAgLy8gY3JlYXRlIGFycm93c1xyXG4gICAgbGV0IGFycm93c0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJESVZcIilcclxuICAgIGlmIChlLnNldHRpbmdzLnNob3dBcnJvd3MgPT0gZmFsc2UpIHtcclxuICAgICAgYXJyb3dzQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY2l0cnVzLWFycm93cyBoaWRkZW5cIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGFycm93c0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNpdHJ1cy1hcnJvd3NcIilcclxuICAgIH1cclxuICAgIGxldCBhcnJvd0xlZnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpXHJcbiAgICBhcnJvd0xlZnQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJzbGlkZS1hcnJvdyBsZWZ0LWFycm93XCIpXHJcbiAgICBsZXQgYXJyb3dSaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJESVZcIilcclxuICAgIGFycm93UmlnaHQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJzbGlkZS1hcnJvdyByaWdodC1hcnJvd1wiKVxyXG4gICAgYXJyb3dzQ29udGFpbmVyLmFwcGVuZENoaWxkKGFycm93TGVmdClcclxuICAgIGFycm93c0NvbnRhaW5lci5hcHBlbmRDaGlsZChhcnJvd1JpZ2h0KVxyXG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoYXJyb3dzQ29udGFpbmVyKVxyXG4gICAgZS5hcnJvd3MgPSBbYXJyb3dMZWZ0LCBhcnJvd1JpZ2h0XVxyXG5cclxuICAgIC8vIGNyZWF0ZSBzbGlkZXNcclxuICAgIGxldCBzbGlkZXNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpXHJcbiAgICBlLnNsaWRlcyA9IHNsaWRlc0NvbnRhaW5lclxyXG4gICAgc2xpZGVzQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY2l0cnVzLXNsaWRlc1wiKVxyXG4gICAgc2xpZGVzQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYW5pbWF0aW9uLWR1cmF0aW9uOlwiICsgZS5zZXR0aW5ncy5hbmltYXRpb25EdXJhdGlvbiArIFwicztcIiArIFwidHJhbnNpdGlvbi1kdXJhdGlvbjpcIiArIGUuc2V0dGluZ3MuYW5pbWF0aW9uRHVyYXRpb24gKyBcInM7XCIpXHJcbiAgICBpZiAoZS5zZXR0aW5ncy5zbGlkZVRyYW5zaXRpb24gPT09IFwicGFuXCIpIHtcclxuICAgICAgc2xpZGVzQ29udGFpbmVyLnN0eWxlLndpZHRoID0gZS5udW0gKyAnMDAlJ1xyXG4gICAgfVxyXG4gICAgLy8gc2V0IGNvbnRhaW5lciB3aWR0aFxyXG4gICAgaWYgKGUuc2V0dGluZ3Muc2xpZGVUcmFuc2l0aW9uID09PSBcInBhblwiKSB7XHJcbiAgICAgIHNsaWRlc0NvbnRhaW5lci5zdHlsZS53aWR0aCA9IGUubnVtICsgJzAwJSdcclxuICAgICAgc2xpZGVzQ29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nICsgZS5zZXR0aW5ncy5zbGlkZUluZGV4IC8gZS5udW0gKiAxMDAgKyAnJSknXHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlLm51bTsgaSsrKSB7XHJcbiAgICAgIGxldCBzbGlkZVdyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpXHJcbiAgICAgIGlmIChpID09PSBlLnNldHRpbmdzLnNsaWRlSW5kZXgpIHtcclxuICAgICAgICBzbGlkZVdyYXAuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJzbGlkZS13cmFwIGN1cnJlbnQtc2xpZGVcIilcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzbGlkZVdyYXAuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJzbGlkZS13cmFwXCIpXHJcbiAgICAgIH1cclxuICAgICAgbGV0IHNsaWRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkRJVlwiKVxyXG4gICAgICBzbGlkZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInNsaWRlXCIpXHJcbiAgICAgIGxldCBzbGlkZVRleHQgPSBlLnNsaWRlVGV4dFtpXVxyXG4gICAgICBzbGlkZVRleHQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJzbGlkZS10ZXh0XCIpXHJcbiAgICAgIHNsaWRlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZS5pbWdVcmxzW2ldICsgXCIpXCJcclxuICAgICAgc2xpZGVXcmFwLmFwcGVuZENoaWxkKHNsaWRlKVxyXG4gICAgICBzbGlkZVdyYXAuYXBwZW5kQ2hpbGQoc2xpZGVUZXh0KVxyXG4gICAgICBzbGlkZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoc2xpZGVXcmFwKVxyXG4gICAgfVxyXG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoc2xpZGVzQ29udGFpbmVyKVxyXG5cclxuICAgIC8vIGNyZWF0ZSBpbmRpY2F0b3IgZWxlbWVudHNcclxuICAgIGUuaW5kaWNhdG9ycyA9IFtdXHJcbiAgICBsZXQgaW5kaWNhdG9yc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJESVZcIilcclxuICAgIGlmIChlLnNldHRpbmdzLnNob3dJbmRpY2F0b3JzID09IGZhbHNlKSB7XHJcbiAgICAgIGluZGljYXRvcnNDb250YWluZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjaXRydXMtaW5kaWNhdG9ycyBoaWRkZW5cIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGluZGljYXRvcnNDb250YWluZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjaXRydXMtaW5kaWNhdG9yc1wiKVxyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlLm51bTsgaSsrKSB7XHJcbiAgICAgIGxldCBpbmRpY2F0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiU1BBTlwiKVxyXG4gICAgICBpZiAoaSA9PT0gZS5zZXR0aW5ncy5zbGlkZUluZGV4KSB7XHJcbiAgICAgICAgaW5kaWNhdG9yLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwic2xpZGUtaW5kaWNhdG9yIGN1cnJlbnQtaW5kaWNhdG9yXCIpXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5kaWNhdG9yLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwic2xpZGUtaW5kaWNhdG9yXCIpXHJcbiAgICAgIH1cclxuICAgICAgaW5kaWNhdG9yLnNldEF0dHJpYnV0ZShcImRhdGEtc2xpZGVcIiwgaSlcclxuICAgICAgaW5kaWNhdG9yc0NvbnRhaW5lci5hcHBlbmRDaGlsZChpbmRpY2F0b3IpXHJcbiAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGluZGljYXRvcnNDb250YWluZXIpXHJcbiAgICAgIGUuaW5kaWNhdG9yc1tpXSA9IGluZGljYXRvclxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNsZWFyIGlubmVySFRNTCBvZiBvcmlnaW5hbCBzbGlkZXMgY29udGFpbmVyIGFuZCBhcHBlbmQgZnJhZ21lbnRcclxuICAgIGUuc2xpZGVyQ29udGFpbmVyLmlubmVySFRNTCA9IFwiXCJcclxuICAgIGUuc2xpZGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KVxyXG4gICAgaWYgKGUuc2V0dGluZ3MuZWZmZWN0ID09PSBcInBhcmFsbGF4XCIpIHtcclxuICAgICAgcGFyYWxsYXhFZmZlY3QoZSlcclxuICAgIH1cclxuICAgIHNldEJpbmRpbmdzKGUpXHJcbiAgfVxyXG5cclxuICAvLyBDUkVBVEUgQklORElOR1MgRk9SIEFSUk9XUyBBTkQgSU5ESUNBVE9SU1xyXG4gIGZ1bmN0aW9uIHNldEJpbmRpbmdzKGUpIHtcclxuXHJcbiAgICAvLyBiaW5kIGFycm93IGNsaWNrIGZ1bmN0aW9uc1xyXG4gICAgZm9yIChsZXQgYXJyb3cgb2YgZS5hcnJvd3MpIHtcclxuICAgICAgYXJyb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICBpZiAoZS5zZXR0aW5ncy5hdXRvUGF1c2UpIHtcclxuICAgICAgICAgIGUuc2V0dGluZ3MucGF1c2VkID0gdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZS5zbGlkZXJDb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYW5pbWF0aW5nXCIpKSB7XHJcbiAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcbiAgICAgICAgZS5zZXR0aW5ncy5wcmV2SW5kZXggPSBlLnNldHRpbmdzLnNsaWRlSW5kZXhcclxuICAgICAgICBpZiAoZWwudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGVmdC1hcnJvdycpKSB7XHJcbiAgICAgICAgICBlLnNldHRpbmdzLnNsaWRlSW5kZXgtLVxyXG4gICAgICAgIH0gZWxzZSBpZiAoZWwudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncmlnaHQtYXJyb3cnKSkge1xyXG4gICAgICAgICAgZS5zZXR0aW5ncy5zbGlkZUluZGV4KytcclxuICAgICAgICB9XHJcbiAgICAgICAgc2xpZGVyQ2hhbmdlKGUpXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gYmluZCBpbmRpY2F0b3IgY2xpY2sgZnVuY3Rpb25zXHJcbiAgICBmb3IgKGxldCBpbmRpY2F0b3Igb2YgZS5pbmRpY2F0b3JzKSB7XHJcbiAgICAgIGluZGljYXRvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgIGlmIChlLnNldHRpbmdzLmF1dG9QYXVzZSkge1xyXG4gICAgICAgICAgZS5zZXR0aW5ncy5wYXVzZWQgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlLnNsaWRlckNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoXCJhbmltYXRpbmdcIikpIHtcclxuICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZWwudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY3VycmVudC1pbmRpY2F0b3InKSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIGUuc2V0dGluZ3MucHJldkluZGV4ID0gZS5zZXR0aW5ncy5zbGlkZUluZGV4XHJcbiAgICAgICAgICBlLnNldHRpbmdzLnNsaWRlSW5kZXggPSBOdW1iZXIoZWwudGFyZ2V0LmRhdGFzZXQuc2xpZGUpXHJcbiAgICAgICAgICBzbGlkZXJDaGFuZ2UoZSlcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBVUERBVEVTIFNMSURFIENMQVNTRVMgQkFTRUQgT04gUFJFVklPVVMgQU5EIENVUlJFTlQgSU5ERVhFUyBcclxuICBmdW5jdGlvbiBzbGlkZXJDaGFuZ2UoZSkge1xyXG4gICAgY2xlYXJUaW1lb3V0KGUuaW50ZXJ2YWxTbGlkZUNoYW5nZSlcclxuICAgIGUucHJldiA9IGUuc2xpZGVyQ29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2N1cnJlbnQtc2xpZGUnKVswXVxyXG5cclxuICAgIC8vIGNhbGN1bGF0ZSBzbGlkZSBpbmRleFxyXG4gICAgaWYgKGUuc2V0dGluZ3Muc2xpZGVJbmRleCA8IDApIHtcclxuICAgICAgZS5zZXR0aW5ncy5zbGlkZUluZGV4ID0gZS5udW0gLSAxXHJcbiAgICAgIGlmIChlLm51bSkge1xyXG4gICAgICAgIGUuaW5kaWNhdG9yc1swXS5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3RyYW5zaXRpb24tbGFzdCcpXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBlLmluZGljYXRvcnNbMF0ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCd0cmFuc2l0aW9uLWxhc3QnKVxyXG4gICAgICAgIH0sIDEwMDApXHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZS5zZXR0aW5ncy5zbGlkZUluZGV4ID4gZS5udW0gLSAxKSB7XHJcbiAgICAgIGUuc2V0dGluZ3Muc2xpZGVJbmRleCA9IDBcclxuICAgICAgaWYgKGUubnVtKSB7XHJcbiAgICAgICAgZS5pbmRpY2F0b3JzWzBdLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgndHJhbnNpdGlvbi1maXJzdCcpXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBlLmluZGljYXRvcnNbMF0ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCd0cmFuc2l0aW9uLWZpcnN0JylcclxuICAgICAgICB9LCAxMDAwKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc2V0IGNsYXNzZXMgYmFzZWQgb24gc2xpZGUgaW5kZXhcclxuICAgIGlmIChlLm51bSA+IDEpIHtcclxuICAgICAgLy8gcmVtb3ZlIGN1cnJlbnQgc3R5bGVzXHJcbiAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2ZvcndhcmRzJywgJ2JhY2t3YXJkcycpXHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZS5udW07IGkrKykge1xyXG4gICAgICAgIGUuc2xpZGVzLmNoaWxkcmVuW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2N1cnJlbnQtc2xpZGUnLCAncHJldi1zbGlkZScsICduZXh0LXNsaWRlJylcclxuICAgICAgICBpZiAoZS5udW0pIHtcclxuICAgICAgICAgIGUuaW5kaWNhdG9yc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdjdXJyZW50LWluZGljYXRvcicpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIGFkZCBkaXJlY3Rpb24gY2xhc3NcclxuICAgICAgaWYgKGUuc2V0dGluZ3MucHJldkluZGV4IDwgZS5zZXR0aW5ncy5zbGlkZUluZGV4KSB7XHJcbiAgICAgICAgZS5zbGlkZXJDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnZm9yd2FyZHMnKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2JhY2t3YXJkcycpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGFkZCBwcmV2aW91cyBzbGlkZVxyXG4gICAgICBlLnByZXYuY2xhc3NMaXN0LmFkZCgncHJldi1zbGlkZScpXHJcblxyXG4gICAgICBpZiAoZS5zZXR0aW5ncy5zbGlkZUluZGV4ID09PSBlLm51bSAtIDEpIHtcclxuICAgICAgICBlLnNsaWRlcy5jaGlsZHJlblswXS5jbGFzc0xpc3QuYWRkKCduZXh0LXNsaWRlJylcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoZS5zbGlkZXMuY2hpbGRyZW5bZS5zZXR0aW5ncy5zbGlkZUluZGV4ICsgMV0pIHtcclxuICAgICAgICAgIGUuc2xpZGVzLmNoaWxkcmVuW2Uuc2V0dGluZ3Muc2xpZGVJbmRleCArIDFdLmNsYXNzTGlzdC5hZGQoJ25leHQtc2xpZGUnKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZS5zbGlkZXMuY2hpbGRyZW5bZS5zZXR0aW5ncy5zbGlkZUluZGV4XS5jbGFzc0xpc3QuYWRkKCdjdXJyZW50LXNsaWRlJylcclxuICAgICAgaWYgKGUubnVtKSB7XHJcbiAgICAgICAgZS5pbmRpY2F0b3JzW2Uuc2V0dGluZ3Muc2xpZGVJbmRleF0uY2xhc3NMaXN0LmFkZCgnY3VycmVudC1pbmRpY2F0b3InKVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChlLnNldHRpbmdzLnNsaWRlVHJhbnNpdGlvbiA9PT0gXCJwYW5cIikge1xyXG4gICAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNoaWxkcmVuWzFdLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nICsgZS5zZXR0aW5ncy5zbGlkZUluZGV4IC8gZS5udW0gKiAxMDAgKyAnJSknXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGFkZCBhbmQgcmVtb3ZlIGFuaW1hdGluZyBjbGFzcyB0byBzbGlkZXIgY29udGFpbmVyXHJcbiAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGluZycpXHJcbiAgICAgIGUuaW50ZXJ2YWxQcmV2QW5pbSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGUuc2xpZGVyQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2FuaW1hdGluZycpXHJcbiAgICAgIH0sIGUuc2V0dGluZ3MuYW5pbWF0aW9uRHVyYXRpb24gKiAxMDAwKVxyXG4gICAgICBhdXRvU2xpZGUoZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEFVVE9NQVRJQyBTTElERSBDSEFOR0lORyBCQVNFRCBPTiBUSU1JTkcgSU4gU0VUVElOR1NcclxuICBmdW5jdGlvbiBhdXRvU2xpZGUoZSkge1xyXG4gICAgaWYgKGUuc2V0dGluZ3MucGF1c2VkID09PSBmYWxzZSkge1xyXG4gICAgICBlLmludGVydmFsU2xpZGVDaGFuZ2UgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBlLnNldHRpbmdzLnByZXZJbmRleCA9IGUuc2V0dGluZ3Muc2xpZGVJbmRleFxyXG4gICAgICAgIGUuc2V0dGluZ3Muc2xpZGVJbmRleCsrXHJcbiAgICAgICAgICBzbGlkZXJDaGFuZ2UoZSlcclxuICAgICAgfSwgZS5zZXR0aW5ncy5zbGlkZUR1cmF0aW9uKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUEFSQUxMQVggRUZGRUNUXHJcbiAgZnVuY3Rpb24gcGFyYWxsYXhFZmZlY3QoZSkge1xyXG4gICAgdXBkYXRlUG9zaXRpb24oZSlcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmIChlLnNldHRpbmdzLmVmZmVjdCA9PT0gXCJwYXJhbGxheFwiKSB7XHJcbiAgICAgICAgdXBkYXRlUG9zaXRpb24oZSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKGUpIHtcclxuICAgIGxldCB3aW5kb3dIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHRcclxuICAgIGlmIChpc1Njcm9sbGVkSW50b1ZpZXcoZS5zbGlkZXJDb250YWluZXIsIHRydWUsIDApKSB7XHJcbiAgICAgIGxldCBvZmZzZXQgPSAoZS5zbGlkZXJDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC8gd2luZG93SGVpZ2h0KSAqIChlLnNsaWRlckhlaWdodCAqIDAuMylcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlLm51bTsgaSsrKSB7XHJcbiAgICAgICAgZS5zbGlkZXMuY2hpbGRyZW5baV0uY2hpbGRyZW5bMF0uc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gJ2NlbnRlciBjYWxjKDUwJSAtICcgKyAob2Zmc2V0KSArICdweCknXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS1IRUxQRVIgRlVOQ1RJT05TLS0tLS0tLS0tLVxcXFxcclxuXHJcbiAgLy8gR0VUIFNMSURFUyBJTk5FUiBDT05URU5UXHJcbiAgZnVuY3Rpb24gZ2V0Q29udGVudChlKSB7XHJcbiAgICBsZXQgc2xpZGVUZXh0ID0ge31cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBzbGlkZVRleHRbaV0gPSBlW2ldXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2xpZGVUZXh0XHJcbiAgfVxyXG5cclxuICAvLyBHRVQgSU1BR0UgVVJMUyBGUk9NIFNMSURFU1xyXG4gIGZ1bmN0aW9uIGdldEltYWdlcyhlKSB7XHJcbiAgICBsZXQgdXJscyA9IEFycmF5LmZyb20oZS5jaGlsZHJlbikubWFwKGUgPT4gZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaW1nJylbMF0uc3JjKVxyXG4gICAgbGV0IGltZyA9IGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbWdcIilcclxuICAgIHdoaWxlIChpbWdbMF0pIHtcclxuICAgICAgaW1nWzBdLnJlbW92ZSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdXJsc1xyXG4gIH1cclxuXHJcbiAgLy8gQ0FMQ1VMQVRFIEhFSUdIVCBPRiBHSVZFTiBTTElERVIgRUxFTUVOVFxyXG4gIGZ1bmN0aW9uIGF1dG9IZWlnaHQoZSkge1xyXG4gICAgbGV0IGhlaWdodCA9IDBcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZS5udW07IGkrKykge1xyXG4gICAgICBsZXQgdGV4dEhlaWdodCA9IGUuc2xpZGVUZXh0W2ldLm9mZnNldEhlaWdodFxyXG4gICAgICBpZiAoaGVpZ2h0IDwgdGV4dEhlaWdodCkge1xyXG4gICAgICAgIGhlaWdodCA9IHRleHRIZWlnaHRcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaGVpZ2h0ICs9IDI1MFxyXG4gICAgcmV0dXJuIGhlaWdodCArIFwicHhcIlxyXG4gIH1cclxuXHJcbiAgLy8gR0VUIFNFVFRJTkdTIEZST00gREFUQSBBVFRSSUJVVEVcclxuICBmdW5jdGlvbiBnZXRTZXR0aW5ncyhlLCBjYikge1xyXG4gICAgLy8gZ2V0IHNldHRpbmdzIGZyb20gZGF0YSBhdHRyaWJ1dGVcclxuICAgIGlmIChlLnNsaWRlckNvbnRhaW5lci5oYXNBdHRyaWJ1dGUoJ2RhdGEtY2l0cnVzJykpIHtcclxuICAgICAgbGV0IHNldHRpbmdzID0gSlNPTi5wYXJzZShlLnNsaWRlckNvbnRhaW5lci5kYXRhc2V0LmNpdHJ1cylcclxuICAgICAgLy8gdXBkYXRlIG9iamVjdFxyXG4gICAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhzZXR0aW5ncykpIHtcclxuICAgICAgICBlLnNldHRpbmdzW2tleV0gPSBzZXR0aW5nc1trZXldXHJcbiAgICAgIH1cclxuICAgICAgZS5zbGlkZXJDb250YWluZXIucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWNpdHJ1cycpXHJcbiAgICAgIGlmIChlLnNldHRpbmdzLnNsaWRlSW5kZXggPiBlLm51bSB8fCBlLnNldHRpbmdzLnNsaWRlSW5kZXggPD0gMCkge1xyXG4gICAgICAgIGUuc2V0dGluZ3Muc2xpZGVJbmRleCA9IDBcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBlLnNldHRpbmdzLnNsaWRlSW5kZXgtLVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgY2IoZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIENIRUNLIElGIFNMSURFUiBJTiBWSUVXXHJcbiAgZnVuY3Rpb24gaXNTY3JvbGxlZEludG9WaWV3KGVsLCBpc1BhcnRpYWwsIG9mZnNldCkge1xyXG4gICAgdmFyIGlzVmlzaWJsZVxyXG4gICAgdmFyIGVsZW1Ub3AgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBvZmZzZXRcclxuICAgIHZhciBlbGVtQm90dG9tID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tIC0gb2Zmc2V0XHJcbiAgICAvLyBPbmx5IGNvbXBsZXRlbHkgdmlzaWJsZSBlbGVtZW50cyByZXR1cm4gdHJ1ZTpcclxuICAgIGlmIChpc1BhcnRpYWwgPT09IHRydWUpIHtcclxuICAgICAgLy8gUGFydGlhbGx5IHZpc2libGUgZWxlbWVudHMgcmV0dXJuIHRydWU6XHJcbiAgICAgIGlzVmlzaWJsZSA9IGVsZW1Ub3AgPCB3aW5kb3cuaW5uZXJIZWlnaHQgJiYgZWxlbUJvdHRvbSA+PSAwXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpc1Zpc2libGUgPSAoZWxlbVRvcCA+PSAwKSAmJiAoZWxlbUJvdHRvbSA8PSB3aW5kb3cuaW5uZXJIZWlnaHQpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gaXNWaXNpYmxlXHJcbiAgfVxyXG5cclxuICAvLyBNQUtFIFNMSURFUk9CSkVDVFMgUFVCTElDIFZJQSBjaXRydXNTbGlkZXJzXHJcbiAgcmV0dXJuIHNsaWRlck9iamVjdHNcclxufSkoKSJdfQ==
